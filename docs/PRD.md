# PRD  
## PhotoRenamer: 파일명 표준화 및 이미지 변환 유틸리티 (Python GUI)

---

## 1. 개요 (Overview)

### 1.1 목적
카메라·편집 툴 등에서 생성된 다양한 사진/영상 파일명을 표준 형식인 `IMG_<번호>` 규칙으로 일괄 변환하고, HEIC/HIF 이미지를 JPG로 자동 변환하는 **로컬 GUI 기반 유틸리티**를 제공한다.

### 1.2 배경
- 다양한 기기(Canon, Pentax 등) 및 소스(Law_, Mey_)의 파일명 규칙 혼재
- 파일명 규칙 불일치로 인한 관리/정렬 문제
- 수작업 변경의 비효율 및 오류 가능성
- 대량 파일 처리 시 안정성과 진행 가시성 필요

---

## 2. 범위 (Scope)

### 포함 (In Scope)
- 로컬 파일/폴더 기반 처리
- GUI를 통한 입력 폴더 지정
- 재귀적 하위 폴더 처리
- 파일명 규칙 변환 (복수 접두사 지원)
- HEIC/HIF 이미지의 JPG 자동 변환
- 진행 상태 실시간 표시 및 처리 로그 제공
- 파일 단위 예외 처리 및 에러 로그 기록

### 제외 (Out of Scope)
- 클라우드 연동
- EXIF 기반 날짜/메타데이터 리네이밍
- 중복 파일 자동 병합/삭제

---

## 3. 사용자 시나리오 (User Flow)

1. 프로그램 실행
2. GUI에서 소스 폴더 선택
3. “변환 시작” 버튼 클릭
4. 하위 폴더를 포함한 처리 진행 상황 실시간 확인
5. 완료 후 결과 폴더 열기 버튼을 통해 결과 확인

---

## 4. 기능 요구사항 (FR)

### FR-01. 입력 폴더 선택 및 구조
- GUI 폴더 선택 다이얼로그 제공
- 소스 폴더 내 **하위 폴더 포함 재귀 처리**
- 소스 폴더 내 `result` 폴더 생성 및 원본 폴더 구조 유지

### FR-02. 파일명 변환 규칙

#### 입력 및 출력 예시
- **Canon 스타일**: `0R2A0813.JPG` → `IMG_0813.jpg`
- **Pentax 스타일**: `IMGP1234.JPG` → `IMG_1234.jpg`
- **Law/Mey 스타일**: 
  - `Law_231009_5019.JPG` → `IMG_5019.jpg`
  - `Mey_123456_7890.JPG` → `IMG_7890.jpg`
- **보정 파일**: `0R2A0813_보정.png` → `IMG_08131.png`
- **보정 번호 증분**: `Law_231009_5019_보정1.jpeg` → `IMG_50192.jpeg`

#### 상세 변환 로직
- **0R2A 접두사**: `0R2A` 제거 후 뒤 4자리 숫자 추출
- **IMGP 접두사**: `IMGP` 제거 후 뒤 4자리 숫자 추출
- **Law_/Mey_ 접두사**: 마지막 언더바(`_`) 뒤의 4자리 숫자 추출
- **`_보정` 태그 처리**:
  - `_보정`만 있을 시 접미사 `1` 추가
  - `_보정N` (숫자) 형태일 시 `N+1`로 계산하여 접미사 추가
- **확장자**: 소문자로 표준화
- **충돌 방지**: 변환 후 동일 파일명 존재 시 파일명 뒤에 숫자 카운터 추가

### FR-03. 호환 확장자 처리
- **사진**: `.cr3`, `.jpg`, `.jpeg`, `.png`, `.gif`, `.heic`, `.hif`, `.dng`
- **영상**: `.mp4`, `.wma`, `.mov`
- **포맷 변환**: `.heic`, `.hif` 파일은 `.jpg`로 변환 저장

### FR-04. 진행 상태 표시 (GUI)
- 전체 처리 예정 파일 수 표시
- 현재 처리 중인 파일명 실시간 로그 출력
- 전체 진행률 (%) 및 진행 바(Progress Bar) 표시

### FR-05. 예외 및 로그 처리
- 단일 파일 처리 오류 시 로그 기록 후 다음 파일 계속 진행
- ERROR 수준의 로그를 `error.log` 파일에 기록

---

## 5. 기술 스택
- **Language**: Python 3.x
- **GUI**: tkinter
- **Image Processing**: Pillow, pillow-heif
- **Packaging**: PyInstaller